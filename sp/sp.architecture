# Architecture Specification: The Physical AI & Humanoid Robotics Book

---

## 1. Top-Level Structure

This book is organized into an introduction, four core learning modules, and appendices. This structure ensures a logical progression from foundational theory to advanced application.

### 1.1. Module & Chapter Mapping

*   **Introduction**
    *   Chapter 00: Welcome to Physical AI (`docs/00-introduction.md`)
*   **Part 1: Foundations of Embodied AI**
    *   Chapter 01: The Vision of Physical AI (`docs/part-1/01-physical-ai-vision.md`)
    *   Chapter 02: The ROS 2 Nervous System (`docs/part-1/02-ros-2-nervous-system.md`)
    *   Chapter 03: Your First Digital Twin with Gazebo (`docs/part-1/03-gazebo-digital-twin.md`)
*   **Part 2: Simulation and Perception**
    *   Chapter 04: High-Fidelity Visualization with Unity (`docs/part-2/04-unity-visualization.md`)
    *   Chapter 05: NVIDIA Isaac Sim for AI Training (`docs/part-2/05-isaac-sim.md`)
    *   Chapter 06: Isaac ROS for Accelerated Perception (`docs`part-2/06-isaac-ros-perception.md`)
*   **Part 3: Intelligence and Action**
    *   Chapter 07: Vision-Language-Action (VLA) Models (`docs/part-3/07-vla-models.md`)
    *   Chapter 08: Integrating LLMs for Task Planning (`docs/part-3/08-llm-task-planning.md`)
    *   Chapter 09: Humanoid Robotics Control (`docs/part-3/09-humanoid-control.md`)
*   **Part 4: Deployment and the Real World**
    *   Chapter 10: The Sim-to-Real Workflow (`docs/part-4/10-sim-to-real.md`)
    *   Chapter 11: Hardware & Lab Architecture (`docs/part-4/11-hardware-lab-architecture.md`)
    *   Chapter 12: Cloud vs. On-Premise Labs (`docs/part-4/12-cloud-vs-onprem.md`)
*   **Capstone Project**
    *   Chapter 13: Building an Autonomous Humanoid Robot (`docs/capstone/13-capstone-project.md`)
*   **Appendices**
    *   Appendix A: Assessment Guide (`docs/appendix/assessment-guide.md`)
    *   Appendix B: Toolchain Setup (`docs/appendix/toolchain-setup.md`)
    *   Appendix C: Central Bibliography (`docs/appendix/bibliography.md`)

---

## 2. Chapter Template

Every chapter `.md` file MUST use the following Markdown template.

```markdown
---
title: "Chapter X: [Chapter Title]"
sidebar_position: X
description: "[A one-sentence summary of the chapter's content and purpose.]"
tags: [keyword1, keyword2, keyword3]
last_reviewed: YYYY-MM-DD
version: 1.0.0
---

# Chapter X: [Chapter Title]

## Summary

[A one-paragraph overview of the chapter's key takeaways.]

## Learning Objectives

*   Objective 1: [e.g., Design a URDF model for a simple robot.]
*   Objective 2: [e.g., Launch and control the robot in a Gazebo simulation.]
*   Objective 3: [e.g., Explain the role of TF2 in ROS 2.]

## Prerequisites

-   **Knowledge:** [e.g., Completion of Chapter X-1.]
-   **Tools:** [e.g., ROS 2 Humble, Gazebo 11.]
-   **Estimated Length:** [e.g., 2 hours]

## Labs & Activities

### Activity X.1: [Activity Title]

**Goal:** [A clear statement of the activity's goal.]

1.  **Step 1:** [Clear, actionable instruction.]
    ```bash
    # example_command --with-args
    ```
2.  **Step 2:** [Next clear, actionable instruction.]

## Code Examples

```python
# /examples/python/chapter-X/example_script.py
# A brief comment explaining the purpose of this script.
def main():
    print("Hello, Physical AI!")

if __name__ == '__main__':
    main()
```

## Diagrams

![System Flow Diagram for Chapter X](./assets/chapter-X-flow.png)

## References

-   (Author, Year). *Title of Work*. Publisher.
-   See full APA citation in `/docs/appendix/bibliography.md`.

## Acceptance Criteria

-   [ ] The simulation launches without errors.
-   [ ] The example code runs and produces the expected output.
-   [ ] The student can answer the key conceptual questions for this chapter.

## Version Log

| Version | Date       | Author      | Notes                 |
|---------|------------|-------------|-----------------------|
| 1.0.0   | YYYY-MM-DD | [Your Name] | Initial Draft         |

```

---

## 3. File & Folder Layout (Docusaurus-Ready)

The repository MUST adhere to the following structure.

```
.
├── docs/                      # All book content.
│   ├── 00-introduction.md
│   ├── part-1/
│   │   ├── 01-physical-ai-vision.md
│   │   └── ...
│   ├── part-2/
│   ├── part-3/
│   ├── part-4/
│   ├── capstone/
│   └── appendix/
│       ├── assessment-guide.md
│       └── bibliography.md
├── examples/                  # Runnable code examples.
│   ├── python/
│   │   └── chapter-01/
│   ├── cpp/
│   └── ros2_ws/                 # ROS 2 workspaces for chapters.
├── assets/                    # Static assets.
│   ├── images/                # Diagrams, screenshots.
│   ├── models/                # URDF, SDF, USD files (managed by Git LFS).
│   └── datasets/              # Sample datasets (managed by Git LFS).
├── src/                       # Docusaurus source files.
│   └── css/
├── static/                    # Docusaurus static files.
│   └── img/
├── sp.architecture            # This file.
├── sp.constitution            # Project constitution.
├── sp.vision                  # Project vision.
├── docusaurus.config.js       # Docusaurus main config.
└── sidebars.js                # Docusaurus sidebar config.
```

-   **Slugs:** URL slugs are determined by the folder structure and filename (e.g., `/docs/part-1/01-physical-ai-vision`).

---

## 4. Metadata & Frontmatter

All `.md` files in `/docs` MUST begin with the following YAML frontmatter.

```yaml
---
title: "Chapter X: [Chapter Title]"
sidebar_position: X # Integer for ordering
description: "[One-sentence summary]"
tags: [keyword1, keyword2]
last_reviewed: YYYY-MM-DD
version: 1.0.0 # Semantic versioning for the chapter
---
```

---

## 5. Sidebar & Navigation Design

The `sidebars.js` file MUST define the following navigation structure.

```javascript
// sidebars.js
module.exports = {
  mainSidebar: [
    { type: 'doc', id: '00-introduction', label: 'Introduction' },
    {
      type: 'category',
      label: 'Part 1: Foundations',
      items: ['part-1/01-physical-ai-vision', 'part-1/02-ros-2-nervous-system', 'part-1/03-gazebo-digital-twin'],
    },
    {
      type: 'category',
      label: 'Part 2: Simulation and Perception',
      items: ['part-2/04-unity-visualization', 'part-2/05-isaac-sim', 'part-2/06-isaac-ros-perception'],
    },
    {
      type: 'category',
      label: 'Part 3: Intelligence and Action',
      items: ['part-3/07-vla-models', 'part-3/08-llm-task-planning', 'part-3/09-humanoid-control'],
    },
    {
      type: 'category',
      label: 'Part 4: Deployment and the Real World',
      items: ['part-4/10-sim-to-real', 'part-4/11-hardware-lab-architecture', 'part-4/12-cloud-vs-onprem'],
    },
    { type: 'doc', id: 'capstone/13-capstone-project', label: 'Capstone Project' },
    {
      type: 'category',
      label: 'Appendices',
      items: ['appendix/assessment-guide', 'appendix/toolchain-setup', 'appendix/bibliography'],
    },
  ],
};
```

---

## 6. Code & Example Management

-   **Location:** All runnable code MUST reside in the `/examples` directory, organized by language and chapter.
-   **Languages:**
    -   Python `3.10` or higher.
    -   ROS 2 `Humble Hawksbill`. Iron is an acceptable alternative if specified.
-   **Testing (CI):**
    -   All Python code must pass `flake8` linting.
    -   All ROS 2 packages MUST build successfully with `colcon build`.
    -   Unit tests (`pytest`) are required for all non-trivial code examples.

---

## 7. Asset Handling

-   **Large Files:** All binary assets larger than 1MB (e.g., `.usd`, `.sdf`, `.png`, `.jpg`, `.zip`) MUST be tracked using `git-lfs`.
-   **Configuration:** The `.gitattributes` file must be configured to track these file types.
-   **Location:** All assets must be stored in the `/assets` directory.

---

## 8. Diagrams & Visualizations

-   **Requirement:** All complex systems MUST be accompanied by a diagram.
-   **Tools:**
    -   **Preferred:** `Mermaid.js` directly within Markdown for simplicity and version control.
    -   **Allowed:** `Diagrams.net` (formerly Draw.io) with `.drawio.png` files (editable PNGs) stored in `/assets/images`.
-   **Example (Mermaid):**
    ```mermaid
    graph TD
        A[User Input] --> B{VLA Model};
        B --> C[Task Plan];
        C --> D{ROS 2 Action Server};
        D --> E[Robot Execution];
    ```

---

## 9. Citation & Source Workflow

1.  **Central Bibliography:** All sources MUST be added to `/docs/appendix/bibliography.md` in APA 7th Edition format.
2.  **In-line Reference:** Chapters must cite sources in-line, referencing the central bibliography.
3.  **Verification:** During the review process, every citation MUST be checked against the source for accuracy as per `/sp.constitution`.

---

## 10. Review, Versioning & Release Process

-   **Branching Model:**
    1.  Create a new branch for each chapter: `feature/chapter-XX-title`.
    2.  Submit a Pull Request (PR) to the `develop` branch for review.
    3.  After approval, merge into `develop`.
    4.  `main` branch is for stable, tagged releases only.
-   **Review Checklist:** Every PR must pass a checklist including: constitutional compliance, code tests passing, link validation, and technical accuracy review by a peer.
-   **Tagging:** Releases will be tagged semantically (e.g., `v1.0.0`) and represent a complete, reviewed state of the book.

---

## 11. CI/CD & Deployment

A minimal GitHub Actions workflow MUST be implemented in `.github/workflows/deploy.yml`.

```yaml
# .github/workflows/deploy.yml
name: Deploy Docusaurus Site

on:
  push:
    branches:
      - main # Deploy on pushes to main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm install
      - name: Build Docusaurus site
        run: npm run build
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build
```

---

## 12. Timeline & Milestones

### 12.1. Hackathon (3-Day) Timeline
-   **Day 1:** Finalize all spec files. Draft Introduction and Part 1 chapters. Set up repo and CI.
-   **Day 2:** Draft Part 2 and Part 3 chapters. Develop and test code examples.
-   **Day 3:** Draft Part 4 and Capstone. Review, edit, and deploy the first version to GitHub Pages.

### 12.2. Course (13-Week) Timeline
-   **Week 0:** Setup & Introduction.
-   **Weeks 1-3:** Part 1 (Chapters 1-3).
-   **Weeks 4-6:** Part 2 (Chapters 4-6).
-   **Weeks 7-9:** Part 3 (Chapters 7-9).
-   **Weeks 10-11:** Part 4 (Chapters 10-12).
-   **Weeks 12-13:** Capstone Project.
